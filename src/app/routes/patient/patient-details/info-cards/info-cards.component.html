<div class="info-cards-grid">
  <!-- Balance Card -->
  <mat-card class="info-card" [class.negative-balance]="patient.balance < 0">
    <div class="info-card-header">
      <h3 class="info-card-title mat-caption">{{ 'patients.balance' | translate }}</h3>
      <button mat-icon-button 
              class="info-card-action-btn"
              [matTooltip]="'patients.add_payment' | translate"
              (click)="addPayment()">
        <mat-icon>add</mat-icon>
      </button>
    </div>
    <mat-card-content class="info-card-content">
      <div class="info-card-details">
        <p class="info-card-value mat-headline-6" [class.negative]="patient.balance < 0">
          {{ patient.balance | currency:'EUR':'symbol':'1.2-2' }}
        </p>
        @if (patient.balance < 0) {
          <span class="info-card-subtitle mat-caption text-warn">
            {{ 'patients.outstanding_balance' | translate }}
          </span>
        }
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Appointments Card -->
  <mat-card class="info-card">
    <div class="info-card-header">
      <h3 class="info-card-title mat-caption">{{ 'patients.next_appointment' | translate }}</h3>
      <button mat-icon-button 
              class="info-card-action-btn"
              [matTooltip]="'patients.schedule_appointment' | translate"
              (click)="scheduleAppointment()">
        <mat-icon>add</mat-icon>
      </button>
    </div>
    <mat-card-content class="info-card-content">
      <div class="info-card-details">
        <p class="info-card-value mat-headline-6">
          {{ nextAppointment?.date || ('patients.no_appointment' | translate) }}
        </p>
        @if (nextAppointment) {
          <span class="info-card-subtitle mat-caption">
            {{ nextAppointment.time }} - {{ nextAppointment.doctor }}
          </span>
        }
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Treatment Summary Card -->
  <mat-card class="info-card">
    <div class="info-card-header">
      <h3 class="info-card-title mat-caption">{{ 'patients.treatments' | translate }}</h3>
      <button mat-icon-button 
              class="info-card-action-btn"
              [matTooltip]="'patients.view_treatments' | translate"
              (click)="viewTreatments()">
        <mat-icon>visibility</mat-icon>
      </button>
    </div>
    <mat-card-content class="info-card-content">
      <div class="info-card-details">
        <p class="info-card-value mat-headline-6">
          {{ treatmentStats.total }}
        </p>
        <span class="info-card-subtitle mat-caption">
          {{ 'patients.last_visit' | translate }}: {{ treatmentStats.lastVisit || 'N/A' }}
        </span>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Medical Notes Card -->
  <mat-card class="info-card">
    <div class="info-card-header">
      <h3 class="info-card-title mat-caption">{{ 'patients.medical_notes' | translate }}</h3>
      <button mat-icon-button 
              class="info-card-action-btn"
              [matTooltip]="'patients.edit_notes' | translate"
              (click)="editMedicalNotes()">
        <mat-icon>edit</mat-icon>
      </button>
    </div>
    <mat-card-content class="info-card-content">
      <div class="info-card-details">
        @if (patient.importantMedicalNotes) {
          <p class="info-card-value mat-body-1 text-truncate">
            {{ patient.importantMedicalNotes }}
          </p>
          <span class="info-card-subtitle mat-caption text-warn">
            {{ 'patients.has_important_notes' | translate }}
          </span>
        } @else {
          <p class="info-card-value mat-body-1">
            {{ 'patients.no_medical_notes' | translate }}
          </p>
        }
      </div>
    </mat-card-content>
  </mat-card>
</div>