<mat-card class="registration-card">
  <!-- Card Header -->
  <mat-card-header>
    <mat-card-title>
      <mat-icon class="header-icon">person_add</mat-icon>
      <span>{{ 'patients.registration.title' | translate }}</span>
    </mat-card-title>
    <mat-card-subtitle>
      {{ 'patients.registration.subtitle' | translate }}
    </mat-card-subtitle>
  </mat-card-header>

  <!-- Form Content -->
  <mat-card-content>
    <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
      <!-- Basic Information Section -->
      <div class="form-section">
        <h3 class="section-title">{{ 'patients.registration.sections.basic_info' | translate }}</h3>
        
        <div class="form-row">
          <!-- Full Name -->
          <mat-form-field  class="full-width">
            <mat-label>{{ 'patients.registration.fields.full_name' | translate }}</mat-label>
            <input
              matInput
              formControlName="fullName"
              [placeholder]="'patients.registration.fields.full_name_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.patient_full_name' | translate"
              maxlength="150"
            />
            <mat-icon matPrefix>person</mat-icon>
            <mat-hint align="end">{{ registrationForm.get('fullName')?.value?.length || 0 }}/150</mat-hint>
            <mat-error>{{ getErrorMessage('fullName') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row two-columns">
          <!-- Date of Birth -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.date_of_birth' | translate }}</mat-label>
            <input
              matInput
              [matDatepicker]="datePicker"
              formControlName="dateOfBirth"
              [placeholder]="'patients.registration.fields.date_of_birth_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.date_of_birth' | translate"
              [max]="maxDate"
            />
            <mat-icon matPrefix>cake</mat-icon>
            <mat-datepicker-toggle matIconSuffix [for]="datePicker"></mat-datepicker-toggle>
            <mat-datepicker #datePicker></mat-datepicker>
            <mat-error>{{ getErrorMessage('dateOfBirth') }}</mat-error>
          </mat-form-field>

          <!-- Gender -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.gender' | translate }}</mat-label>
            <mat-select formControlName="gender" [attr.aria-label]="'patients.registration.aria_labels.gender' | translate">
              <mat-option [value]="">{{ 'patients.registration.fields.gender_not_specified' | translate }}</mat-option>
              <mat-option *ngFor="let option of genderOptions" [value]="option.value">
                {{ option.label | translate }}
              </mat-option>
            </mat-select>
            <mat-icon matPrefix>wc</mat-icon>
            <mat-error>{{ getErrorMessage('gender') }}</mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="form-section">
        <h3 class="section-title">{{ 'patients.registration.sections.contact_info' | translate }}</h3>
        
        <div class="form-row two-columns">
          <!-- Phone Number -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.phone_number' | translate }}</mat-label>
            <input
              matInput
              formControlName="phoneNumber"
              [placeholder]="'patients.registration.fields.phone_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.phone_number' | translate"
              maxlength="30"
            />
            <mat-icon matPrefix>phone</mat-icon>
            <mat-hint align="end">{{ registrationForm.get('phoneNumber')?.value?.length || 0 }}/30</mat-hint>
            <mat-error>{{ getErrorMessage('phoneNumber') }}</mat-error>
          </mat-form-field>

          <!-- Email -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.email' | translate }}</mat-label>
            <input
              matInput
              formControlName="email"
              [placeholder]="'patients.registration.fields.email_placeholder' | translate"
              type="email"
              [attr.aria-label]="'patients.registration.aria_labels.email_address' | translate"
              maxlength="100"
            />
            <mat-icon matPrefix>email</mat-icon>
            <mat-hint align="end">{{ registrationForm.get('email')?.value?.length || 0 }}/100</mat-hint>
            <mat-error>{{ getErrorMessage('email') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Address -->
          <mat-form-field  class="full-width">
            <mat-label>{{ 'patients.registration.fields.address' | translate }}</mat-label>
            <textarea
              matInput
              formControlName="address"
              [placeholder]="'patients.registration.fields.address_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.patient_address' | translate"
              rows="3"
              cdkTextareaAutosize
              cdkAutosizeMinRows="2"
              cdkAutosizeMaxRows="5"
            ></textarea>
            <mat-icon matPrefix>home</mat-icon>
          </mat-form-field>
        </div>
      </div>

      <!-- Insurance Information Section -->
      <div class="form-section">
        <h3 class="section-title">{{ 'patients.registration.sections.insurance_info' | translate }}</h3>
        
        <div class="form-row two-columns">
          <!-- Insurance Provider -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.insurance_provider' | translate }}</mat-label>
            <input
              matInput
              formControlName="insuranceProvider"
              [placeholder]="'patients.registration.fields.insurance_provider_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.insurance_provider' | translate"
              maxlength="100"
            />
            <mat-icon matPrefix>health_and_safety</mat-icon>
            <mat-hint align="end">{{ registrationForm.get('insuranceProvider')?.value?.length || 0 }}/100</mat-hint>
            <mat-error>{{ getErrorMessage('insuranceProvider') }}</mat-error>
          </mat-form-field>

          <!-- Insurance Number -->
          <mat-form-field >
            <mat-label>{{ 'patients.registration.fields.insurance_number' | translate }}</mat-label>
            <input
              matInput
              formControlName="insuranceNumber"
              [placeholder]="'patients.registration.fields.insurance_number_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.insurance_number' | translate"
              maxlength="50"
            />
            <mat-icon matPrefix>credit_card</mat-icon>
            <mat-hint align="end">{{ registrationForm.get('insuranceNumber')?.value?.length || 0 }}/50</mat-hint>
            <mat-error>{{ getErrorMessage('insuranceNumber') }}</mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Medical Information Section -->
      <div class="form-section">
        <h3 class="section-title">{{ 'patients.registration.sections.medical_info' | translate }}</h3>
        
        <div class="form-row">
          <!-- Important Medical Notes -->
          <mat-form-field  class="full-width">
            <mat-label>{{ 'patients.registration.fields.medical_notes' | translate }}</mat-label>
            <textarea
              matInput
              formControlName="importantMedicalNotes"
              [placeholder]="'patients.registration.fields.medical_notes_placeholder' | translate"
              [attr.aria-label]="'patients.registration.aria_labels.medical_notes' | translate"
              rows="4"
              cdkTextareaAutosize
              cdkAutosizeMinRows="3"
              cdkAutosizeMaxRows="8"
            ></textarea>
            <mat-icon matPrefix>medical_information</mat-icon>
            <mat-hint>{{ 'patients.registration.fields.medical_notes_hint' | translate }}</mat-hint>
          </mat-form-field>
        </div>
      </div>
    </form>
  </mat-card-content>

  <!-- Form Actions -->
  <mat-card-actions align="end">
    <button
      mat-button
      type="button"
      (click)="onCancel()"
      [disabled]="loading()"
    >
      {{ 'patients.registration.actions.cancel' | translate }}
    </button>
    <button
      matButton="filled"
      type="submit"
      (click)="onSubmit()"
      [disabled]="registrationForm.invalid || loading()"
    >
      <mat-icon *ngIf="!loading()">save</mat-icon>
      <mat-spinner *ngIf="loading()" diameter="20"></mat-spinner>
      <span>{{ loading() ? ('patients.registration.actions.registering' | translate) : ('patients.registration.actions.register' | translate) }}</span>
    </button>
  </mat-card-actions>
</mat-card>