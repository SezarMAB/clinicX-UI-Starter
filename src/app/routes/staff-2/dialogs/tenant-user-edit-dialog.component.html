<div class="dialog-header">
  <h2>
    <mat-icon>edit</mat-icon>
    {{ 'staff.edit_dialog.title' | translate }}
  </h2>
</div>

<form [formGroup]="editForm" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <div class="form-container">
      <mat-form-field appearance="outline">
        <mat-label>{{ 'staff.create_dialog.fields.username' | translate }}</mat-label>
        <input matInput [value]="data.username" disabled />
        <mat-icon matSuffix>account_circle</mat-icon>
        <mat-hint>{{ 'staff.edit_dialog.username_cannot_change' | translate }}</mat-hint>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>{{ 'staff.create_dialog.fields.email' | translate }}</mat-label>
        <input matInput formControlName="email" type="email" />
        <mat-icon matSuffix>email</mat-icon>
        @if (editForm.get('email')?.hasError('email')) {
          <mat-error>{{ 'staff.edit_dialog.fields.email_invalid' | translate }}</mat-error>
        }
      </mat-form-field>

      <div class="row">
        <mat-form-field appearance="outline">
          <mat-label>{{ 'staff.create_dialog.fields.first_name' | translate }}</mat-label>
          <input matInput formControlName="firstName" />
          <mat-icon matSuffix>person</mat-icon>
          @if (editForm.get('firstName')?.hasError('maxlength')) {
            <mat-error>{{ 'staff.edit_dialog.fields.first_name_maxlength' | translate }}</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ 'staff.create_dialog.fields.last_name' | translate }}</mat-label>
          <input matInput formControlName="lastName" />
          <mat-icon matSuffix>person</mat-icon>
          @if (editForm.get('lastName')?.hasError('maxlength')) {
            <mat-error>{{ 'staff.edit_dialog.fields.last_name_maxlength' | translate }}</mat-error>
          }
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline">
        <mat-label>{{ 'staff.create_dialog.fields.phone_number' | translate }}</mat-label>
        <input matInput formControlName="phoneNumber" placeholder="+1234567890" />
        <mat-icon matSuffix>phone</mat-icon>
        @if (editForm.get('phoneNumber')?.hasError('pattern')) {
          <mat-error>{{ 'staff.edit_dialog.fields.phone_invalid' | translate }}</mat-error>
        }
      </mat-form-field>

      <mat-slide-toggle formControlName="enabled" class="full-width">
        {{ 'staff.edit_dialog.account_enabled' | translate }}
      </mat-slide-toggle>

      <div class="attributes-section">
        <h3>{{ 'staff.edit_dialog.additional_attributes' | translate }}</h3>
        <div formGroupName="attributes">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'staff.create_dialog.fields.department' | translate }}</mat-label>
            <input matInput formControlName="department" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'staff.create_dialog.fields.specialization' | translate }}</mat-label>
            <input matInput formControlName="specialization" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ 'staff.create_dialog.fields.license_number' | translate }}</mat-label>
            <input matInput formControlName="licenseNumber" />
          </mat-form-field>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()" [disabled]="isLoading">{{ 'staff.edit_dialog.actions.cancel' | translate }}</button>
    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="editForm.invalid || isLoading"
    >
      @if (isLoading) {
        <mat-spinner diameter="20" class="btn-spinner"></mat-spinner>
      } @else {
        <span class="btn-content">
          <mat-icon>save</mat-icon>
          <span>{{ 'staff.edit_dialog.actions.save_changes' | translate }}</span>
        </span>
      }
    </button>
  </mat-dialog-actions>
</form>