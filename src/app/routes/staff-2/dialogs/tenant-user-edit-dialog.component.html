<div class="dialog-header">
  <h2>
    <mat-icon>edit</mat-icon>
    Edit User
  </h2>
</div>

<form [formGroup]="editForm" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <div class="form-container">
      <mat-form-field appearance="outline">
        <mat-label>Username</mat-label>
        <input matInput [value]="data.username" disabled />
        <mat-icon matSuffix>account_circle</mat-icon>
        <mat-hint>Username cannot be changed</mat-hint>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput formControlName="email" type="email" />
        <mat-icon matSuffix>email</mat-icon>
        @if (editForm.get('email')?.hasError('email')) {
          <mat-error>Please enter a valid email address</mat-error>
        }
      </mat-form-field>

      <div class="row">
        <mat-form-field appearance="outline">
          <mat-label>First Name</mat-label>
          <input matInput formControlName="firstName" />
          <mat-icon matSuffix>person</mat-icon>
          @if (editForm.get('firstName')?.hasError('maxlength')) {
            <mat-error>First name must not exceed 100 characters</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Last Name</mat-label>
          <input matInput formControlName="lastName" />
          <mat-icon matSuffix>person</mat-icon>
          @if (editForm.get('lastName')?.hasError('maxlength')) {
            <mat-error>Last name must not exceed 100 characters</mat-error>
          }
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline">
        <mat-label>Phone Number</mat-label>
        <input matInput formControlName="phoneNumber" placeholder="+1234567890" />
        <mat-icon matSuffix>phone</mat-icon>
        @if (editForm.get('phoneNumber')?.hasError('pattern')) {
          <mat-error>Please enter a valid phone number</mat-error>
        }
      </mat-form-field>

      <mat-slide-toggle formControlName="enabled" class="full-width">
        Account Enabled
      </mat-slide-toggle>

      <div class="attributes-section">
        <h3>Additional Attributes</h3>
        <div formGroupName="attributes">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Department</mat-label>
            <input matInput formControlName="department" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Specialization</mat-label>
            <input matInput formControlName="specialization" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>License Number</mat-label>
            <input matInput formControlName="licenseNumber" />
          </mat-form-field>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()" [disabled]="isLoading">Cancel</button>
    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="editForm.invalid || isLoading"
    >
      @if (isLoading) {
        <mat-spinner diameter="20" class="btn-spinner"></mat-spinner>
      } @else {
        <span class="btn-content">
          <mat-icon>save</mat-icon>
          <span>Save Changes</span>
        </span>
      }
    </button>
  </mat-dialog-actions>
</form>